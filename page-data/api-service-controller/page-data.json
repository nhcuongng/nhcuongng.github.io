{"componentChunkName":"component---src-templates-post-js","path":"/api-service-controller/","result":{"data":{"markdownRemark":{"html":"<h2 id=\"ý-tưởng\" style=\"position:relative;\"><a href=\"#%C3%BD-t%C6%B0%E1%BB%9Fng\" aria-label=\"ý tưởng permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ý tưởng</h2>\n<p>Mọi request, mọi config (headers, handle errors...) ta sẽ xử lý tập trung và component chỉ việc lấy ra và sử dụng. Sau đó trả về kết quả mong muốn, component không cần biết quá trình xử lý như thế nào.</p>\n<h2 id=\"nào-bắt-đầu-thôi\" style=\"position:relative;\"><a href=\"#n%C3%A0o-b%E1%BA%AFt-%C4%91%E1%BA%A7u-th%C3%B4i\" aria-label=\"nào bắt đầu thôi permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nào bắt đầu thôi</h2>\n<p>Để hiểu đọc hiểu được bài viết này bạn cần ít nhất trang bị kiến thức về JS và một chút OOP.\nMình sẽ lợi dụng tính chất bao đóng của OOP để gói gọn lại toàn bộ những biến, phương thức liên quan vào một class</p>\n<h2 id=\"xây-dựng-class-api-service-controller\" style=\"position:relative;\"><a href=\"#x%C3%A2y-d%E1%BB%B1ng-class-api-service-controller\" aria-label=\"xây dựng class api service controller permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Xây dựng class API Service Controller</h2>\n<h3 id=\"chuẩn-bị-các-type\" style=\"position:relative;\"><a href=\"#chu%E1%BA%A9n-b%E1%BB%8B-c%C3%A1c-type\" aria-label=\"chuẩn bị các type permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Chuẩn bị các type</h3>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">// type cho header object</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">ApiHeader</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>x<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// type cho các method mà API Service Controller hỗ trợ</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">ApiMethod</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"POST\"</span> <span class=\"token operator\">|</span> <span class=\"token string\">\"GET\"</span> <span class=\"token operator\">|</span> <span class=\"token string\">\"PUT\"</span> <span class=\"token operator\">|</span> <span class=\"token string\">\"DELETE\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"khai-báo-các-biến-và-gettersetter\" style=\"position:relative;\"><a href=\"#khai-b%C3%A1o-c%C3%A1c-bi%E1%BA%BFn-v%C3%A0-gettersetter\" aria-label=\"khai báo các biến và gettersetter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Khai báo các biến và getter/setter</h3>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">APIService</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/**\n   * @memberof APIService\n   *\n   * Methods\n   */</span>\n  <span class=\"token keyword\">private</span> method<span class=\"token operator\">:</span> ApiMethod <span class=\"token operator\">=</span> <span class=\"token string\">'GET'</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">/**\n   * @memberof APIService\n   *\n   * Headers's request\n   */</span>\n  <span class=\"token keyword\">private</span> headers<span class=\"token operator\">:</span> ApiHeader <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">/**\n   * @memberof APIService\n   *\n   * Error handler for error requests\n   */</span>\n  <span class=\"token keyword\">static</span> errorHandler<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">/**\n   * @memberof APIService\n   *\n   * Handle loading for wait response\n   */</span>\n  <span class=\"token keyword\">static</span> loadingHandler<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">/**\n   * @memberof APIService\n   *\n   * Authentication token\n   */</span>\n  <span class=\"token keyword\">static</span> token<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">/**\n   * @memberof APIService\n   *\n   * url base - host's server\n   */</span>\n  <span class=\"token keyword\">static</span> urlBase<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">=</span> <span class=\"token string\">'http://localhost:3000'</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">set</span> <span class=\"token function\">token</span><span class=\"token punctuation\">(</span>t<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>token <span class=\"token operator\">=</span> t<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">set</span> <span class=\"token function\">urlBase</span><span class=\"token punctuation\">(</span>url<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>urlBase <span class=\"token operator\">=</span> url<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">set</span> <span class=\"token function\">errorHandler</span><span class=\"token punctuation\">(</span>_errHandle<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>errorHandler <span class=\"token operator\">=</span> _errHandle<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">setHeaders</span><span class=\"token punctuation\">(</span>headers<span class=\"token operator\">:</span> ApiHeader<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>headers <span class=\"token operator\">=</span> headers<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">setMethod</span><span class=\"token punctuation\">(</span>_method<span class=\"token operator\">:</span> ApiMethod<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>method <span class=\"token operator\">=</span> _method<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token function\">_callErrorHandler</span><span class=\"token punctuation\">(</span>msg<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>APIService<span class=\"token punctuation\">.</span>errorHandler<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      APIService<span class=\"token punctuation\">.</span><span class=\"token function\">errorHandler</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token function\">_callLoadingHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>APIService<span class=\"token punctuation\">.</span>loadingHandler<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      APIService<span class=\"token punctuation\">.</span><span class=\"token function\">loadingHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Có một lưu ý nho nhỏ, mình lưu token vào biến token nhưng thực tế các bạn có thể lưu chúng vào localStorage hoặc cookie nhé</p>\n<p>Ý nghĩa của từng biến mình đã ghi rõ trong snippet ở trên.\nMình sẽ giải thích tại sao lại dùng <code class=\"language-text\">private</code> và <code class=\"language-text\">static</code> với các biến tương ứng</p>\n<ul>\n<li>Đầu tiên mình có 3 biến <code class=\"language-text\">private</code> là <code class=\"language-text\">method, headers, errorHandler</code>. Đây là biến của thực thể, nghĩa là khi mà một thực thể tạo được tạo ra từ class của <code class=\"language-text\">APIService</code> sẽ có những thuộc tính  là như thế. Giả sử sau này mình có một <code class=\"language-text\">class Post</code> (extends từ <code class=\"language-text\">APIService</code>) chuyên handle các request liên quan đến <code class=\"language-text\">Post</code> thì chúng sẽ có những <code class=\"language-text\">method, headers, errorHandler</code> riêng</li>\n<li>Kế đó là 2 biến kiểu <code class=\"language-text\">static</code> là <code class=\"language-text\">token</code> và <code class=\"language-text\">urlBase</code>, chúng là biến của lớp, sẽ xuyên suốt các object được tạo ra bởi <code class=\"language-text\">APIService</code> cũng như các class được extends từ <code class=\"language-text\">APIService</code>. Hay nói cách khác nó biến dùng chung</li>\n</ul>\n<p>Các bạn có thể đọc thêm ở <a href=\"https://viblo.asia/p/tu-khoa-static-trong-java-va-lap-trinh-huong-doi-tuong-Qpmlex7rZrd\">đây</a></p>\n<h3 id=\"tạo-ra-các-request-bằng-axios\" style=\"position:relative;\"><a href=\"#t%E1%BA%A1o-ra-c%C3%A1c-request-b%E1%BA%B1ng-axios\" aria-label=\"tạo ra các request bằng axios permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tạo ra các request bằng axios</h3>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">APIService</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// other lines code</span>\n  \n\n  <span class=\"token comment\">/**\n   *  determine method use by axios\n   *\n   * @param slug sub url to server\n   * @param body mothods PUT, POST.. need body\n   */</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token generic-function\"><span class=\"token function\">_fetch</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>RequestBody<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>slug<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> body<span class=\"token operator\">?</span><span class=\"token operator\">:</span> RequestBody<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token constant\">END_POINT</span> <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>APIService<span class=\"token punctuation\">.</span>urlBase<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>slug<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> axiosConfig<span class=\"token operator\">:</span> AxiosRequestConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> token <span class=\"token operator\">=</span> APIService<span class=\"token punctuation\">.</span>token<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      axiosConfig<span class=\"token punctuation\">.</span>headers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        Authorization<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Bearer </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>token<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// nếu header tồn tại</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">.</span><span class=\"token keyword\">constructor</span> <span class=\"token operator\">===</span> Object<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      axiosConfig<span class=\"token punctuation\">.</span>headers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>axiosConfig<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">,</span>\n        <span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>method<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">case</span> <span class=\"token string\">'GET'</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token operator\">&lt;</span>RequestBody<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token constant\">END_POINT</span><span class=\"token punctuation\">,</span> axiosConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">case</span> <span class=\"token string\">'POST'</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">post</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>RequestBody<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">END_POINT</span><span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">,</span> axiosConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">case</span> <span class=\"token string\">'DELETE'</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token keyword\">delete</span><span class=\"token operator\">&lt;</span>RequestBody<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token constant\">END_POINT</span><span class=\"token punctuation\">,</span> axiosConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">case</span> <span class=\"token string\">'PUT'</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">return</span> axios<span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">put</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>RequestBody<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">END_POINT</span><span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">,</span> axiosConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Method is not support or is invalid'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">RequestBody</code> là generic type, type safe cho body gửi lên (nếu bạn chưa hiểu về generic thì lên google tìm hiểu nha). Còn nếu biết về generic nhưng nhìn hơi loạn hãy xem link git mình để cuối bài nhé</p>\n<p>Đến hàm này chúng ta sẽ dựa vào <code class=\"language-text\">APIService.urlBase</code> để ghép vào <code class=\"language-text\">slug</code> để tạo ra một endpoint hoàn chỉnh.\nCheck token cũng như headers (nếu có) để gửi lên server. Cuối cùng ta dựa vào <code class=\"language-text\">this.method</code> để để xem method nào sẽ được gửi lên</p>\n<h3 id=\"handle-resultserror\" style=\"position:relative;\"><a href=\"#handle-resultserror\" aria-label=\"handle resultserror permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Handle results/error</h3>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">APIService</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// other lines code</span>\n\n  <span class=\"token comment\">/**\n   * Parse result from ```thís._fetch()```\n   * \n   * You can use alter to show message error\n   * \n   * Except error > 499 need show page error (or something else) because is fatal error\n   * \n   * @param result\n   */</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token generic-function\"><span class=\"token function\">_parseResult</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>ResponseBody<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>\n    result<span class=\"token operator\">:</span> AxiosResponse<span class=\"token operator\">&lt;</span>ResponseBody<span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span> status<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>result <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>result<span class=\"token punctuation\">.</span>status<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        success<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        error<span class=\"token operator\">:</span> <span class=\"token string\">'error:network_error'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">let</span> msg <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>status <span class=\"token operator\">></span> <span class=\"token number\">499</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      msg <span class=\"token operator\">=</span> msg <span class=\"token operator\">||</span> <span class=\"token string\">'error:server_error'</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_callErrorHandler</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        success<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        error<span class=\"token operator\">:</span> msg<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>status <span class=\"token operator\">===</span> <span class=\"token number\">401</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        success<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        error<span class=\"token operator\">:</span> msg <span class=\"token operator\">||</span> <span class=\"token string\">'error:unauthorized'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>status <span class=\"token operator\">></span> <span class=\"token number\">399</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        success<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n        error<span class=\"token operator\">:</span> msg <span class=\"token operator\">||</span> <span class=\"token string\">'error:generic'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>status <span class=\"token operator\">></span> <span class=\"token number\">199</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>token<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        APIService<span class=\"token punctuation\">.</span>token <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>token<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        success<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        data<span class=\"token operator\">:</span> result<span class=\"token punctuation\">.</span>data <span class=\"token keyword\">as</span> ResponseBody<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      success<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      error<span class=\"token operator\">:</span> msg <span class=\"token operator\">||</span> <span class=\"token string\">'error:generic'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">ResponseBody</code> là generic type, type safe cho kết quả nhận về (nếu bạn chưa hiểu về generic thì lên google tìm hiểu nha). Còn nếu biết về generic nhưng nhìn hơi loạn hãy xem link git mình để cuối bài nhé</p>\n<p>Hàm này sẽ check status trả về và return lại message cũng như data nếu thành công. Xem thêm về <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Status\">HTTP response status codes</a></p>\n<h3 id=\"request-lên-server\" style=\"position:relative;\"><a href=\"#request-l%C3%AAn-server\" aria-label=\"request lên server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Request lên server</h3>\n<p>Chúng ta đã chuẩn bị hàm <code class=\"language-text\">this._fetch</code> để lấy phương thức <code class=\"language-text\">axios</code> tương ứng cùng với đó là hàm <code class=\"language-text\">this._parseResult</code>, phân tích dữ liệu đã trả về. Giờ gộp chúng lại ta sẽ có một phương thức hoàn chỉnh</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">APIService</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// other lines code</span>\n\n\n  <span class=\"token comment\">/**\n   * Sending request to server\n   * \n   * Support generic type for ```ResponseBody``` and ```RequestBody```\n   * \n   * @description\n   * - ```ResponseBody```: type safe for response receive from server\n   * - ```RequestBody```: type safe for request body send to server\n   * \n   * @param slug\n   * @param body\n   */</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">async</span> <span class=\"token generic-function\"><span class=\"token function\">request</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>\n    ResponseBody <span class=\"token operator\">=</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">,</span>\n    RequestBody <span class=\"token operator\">=</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>slug<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> body<span class=\"token operator\">?</span><span class=\"token operator\">:</span> RequestBody<span class=\"token punctuation\">,</span> isLoading<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      isLoading <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_callLoadingHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">_fetch</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>RequestBody<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>slug<span class=\"token punctuation\">,</span> body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setHeaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// reset header sau khi gửi request</span>\n      isLoading <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_callLoadingHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">_parseResult</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>ResponseBody<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">.</span>response <span class=\"token operator\">&amp;&amp;</span> error<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>status<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_parseResult</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n          status<span class=\"token operator\">:</span> error<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>status<span class=\"token punctuation\">,</span>\n          data<span class=\"token operator\">:</span> error<span class=\"token punctuation\">.</span>response<span class=\"token punctuation\">.</span>data <span class=\"token keyword\">as</span> ResponseBody<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">_parseResult</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>ResponseBody<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Vậy là chúng ta đã xong phương thức chính dùng để <code class=\"language-text\">request</code> lên server. Vậy làm sao để sử dụng class này?</p>\n<h2 id=\"áp-dụng-apiservice-vào-thực-tế\" style=\"position:relative;\"><a href=\"#%C3%A1p-d%E1%BB%A5ng-apiservice-v%C3%A0o-th%E1%BB%B1c-t%E1%BA%BF\" aria-label=\"áp dụng apiservice vào thực tế permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Áp dụng APIService vào thực tế</h2>\n<h3 id=\"xây-dựng-class-post\" style=\"position:relative;\"><a href=\"#x%C3%A2y-d%E1%BB%B1ng-class-post\" aria-label=\"xây dựng class post permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Xây dựng class Post</h3>\n<p>Mình sẽ xây dựng <code class=\"language-text\">class Post</code>, extends từ <code class=\"language-text\">class APIService</code>. Nó sẽ chuyên handle các request liên quan đến post</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Post</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">APIService</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">static</span> slug <span class=\"token operator\">=</span> <span class=\"token string\">'/posts'</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">set</span> <span class=\"token function\">slug</span> <span class=\"token punctuation\">(</span>_url<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    Post<span class=\"token punctuation\">.</span>slug <span class=\"token operator\">=</span> _url<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">get</span> <span class=\"token function\">slug</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> Post<span class=\"token punctuation\">.</span>slug<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">async</span> <span class=\"token function\">getPosts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">setMethod</span><span class=\"token punctuation\">(</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span>Post<span class=\"token punctuation\">.</span>slug<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">async</span> <span class=\"token function\">getPost</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">setMethod</span><span class=\"token punctuation\">(</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">request</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>IResponseBodyPost<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Post<span class=\"token punctuation\">.</span>slug<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">async</span> <span class=\"token function\">createPost</span><span class=\"token punctuation\">(</span>post<span class=\"token operator\">:</span> IRequestBodyPost<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">setHeaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        test<span class=\"token operator\">:</span> <span class=\"token string\">'this is a header'</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">setMethod</span><span class=\"token punctuation\">(</span><span class=\"token string\">'POST'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">request</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>IResponseBodyPost<span class=\"token punctuation\">,</span> IRequestBodyPost<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>Post<span class=\"token punctuation\">.</span>slug<span class=\"token punctuation\">,</span> post<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Kế đó tạo một thực thể dựa trên class này. Thực thể này sẽ được dùng ở component cần request dữ liệu lên server</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> PostApi <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Post</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"xây-dựng-component\" style=\"position:relative;\"><a href=\"#x%C3%A2y-d%E1%BB%B1ng-component\" aria-label=\"xây dựng component permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Xây dựng component</h3>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useCallback<span class=\"token punctuation\">,</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> PostApi<span class=\"token punctuation\">,</span> APIService <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../API/Post'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> DisplayResult <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./displayResults'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> GetPosts<span class=\"token operator\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">FC</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>res<span class=\"token punctuation\">,</span> setRes<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// update urlBase cho APIService</span>\n    APIService<span class=\"token punctuation\">.</span>urlBase <span class=\"token operator\">=</span> <span class=\"token string\">'https://jsonplaceholder.typicode.com'</span><span class=\"token punctuation\">;</span>\n    APIService<span class=\"token punctuation\">.</span>token <span class=\"token operator\">=</span> <span class=\"token string\">'SOME_SECRET'</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> handlegetPosts <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> _res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> PostApi<span class=\"token punctuation\">.</span><span class=\"token function\">getPosts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// get all posts</span>\n    <span class=\"token function\">setRes</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>_res<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> handlegetPost <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> _res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> PostApi<span class=\"token punctuation\">.</span><span class=\"token function\">getPost</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// get specified post</span>\n    <span class=\"token function\">setRes</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>_res<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> handleCreatePost <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// create new post</span>\n    <span class=\"token keyword\">const</span> _res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> PostApi<span class=\"token punctuation\">.</span><span class=\"token function\">createPost</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      title<span class=\"token operator\">:</span> <span class=\"token string\">'create new blog with API Service Controller'</span><span class=\"token punctuation\">,</span>\n      body<span class=\"token operator\">:</span> <span class=\"token string\">'Dummy code...'</span><span class=\"token punctuation\">,</span>\n      userId<span class=\"token operator\">:</span> <span class=\"token string\">'Mason Nguyen'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setRes</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>_res<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> clearPost <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setRes</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handlegetPosts<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Get posts<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handleCreatePost<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Create posts<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">handlegetPost</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Get post <span class=\"token function\">specified</span> <span class=\"token punctuation\">(</span>edit <span class=\"token keyword\">in</span> code<span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>clearPost<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Clear posts<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>DisplayResult txt<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>res<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>XONG. Bạn nhìn thấy thật đơn giản phải không? 3 request nhưng nhìn rất ngắn, rất dễ đọc</p>\n<h2 id=\"source-code\" style=\"position:relative;\"><a href=\"#source-code\" aria-label=\"source code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Source code</h2>\n<p>Ở trên mình đa viết component <code class=\"language-text\">getPost</code> để handle request đến post, ngoài ra trong code của mình còn có component <code class=\"language-text\">getTodos</code>, các bạn tham khảo ở <a href=\"https://github.com/nhcuongng/API-Service-Controller\">github của mình</a></p>\n<h2 id=\"kết-luận\" style=\"position:relative;\"><a href=\"#k%E1%BA%BFt-lu%E1%BA%ADn\" aria-label=\"kết luận permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kết luận</h2>\n<p>Việc kiểm soát các request code tốt và tập trung một chỗ kiểu này sẽ giúp chúng ta maintain code tốt hơn, dễ đọc hơn và thêm được nhiều tuỳ biến chung hoặc riêng nhờ vào tính chất của class.</p>","excerpt":"Ý tưởng Mọi request, mọi config (headers, handle errors...) ta sẽ xử lý tập trung và component chỉ việc lấy ra và sử dụng. Sau đó trả về kết…","fields":{"slug":"/api-service-controller/"},"frontmatter":{"title":"API Service Controller - Quản lý toàn bộ request lên server","date":"December 27, 2020","tags":["typescript"],"description":"easy to write, easy to read, easy to maintain","thumbnail":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAAB8UlEQVQ4y+1TPSxDURS+fR6jpdgtdiYxSsRgIsHEyGDx277nVSLSDiKx6NCBppKGhsFkqEFSEdr3oxVarWrRiCpNg2r7VLXOfS9taZFg9XLzcnLO/b7znZ+L0CT/+/MP/gNY8dkpRhmeYH4Ezt8mNQImovkKjUAwwmeyVRwaZ9EEiw3ZHmORmsMUYw6kYvGdUclg3oGBD8K09cp3l9oPPe2cx3cu4vZQ3BNJ9q4G0LC9by14cJ0IxESzM1o/d4QoibGgCihnbeEHMRO6f87lculMNhgTH8UMgJv0HvBAyB1JgqHfj4AogimpmebBWzPjBMzxTRK0kOAZcVDWK8AMrgXRwG67ya/UuhDNKUpqrgAyiqvTuRLpV+9tCqnZqilcTvdKAMDuSKrHEiQp3AuFpqxhWImaq9Vi8AmAVSymo3mS4Y1CNCd93rtUm/EUQqWyZXCN1pXMg7E2yUmMONpNp1b/g1x8w/wx7vn3YEIqpHr6oHHBjYb20OCuzhbG9W9c4pmhjzskg5/Sr55C5kl+S0o4uhlqXfRtBx7B7jSf4cmXZ4aGiS/ZYs0qtst8Fo6nAZPJZuFvOYyRUi/KHgbNV04JrUu+FoMX5iHvLChUzjg7lv396+fNhhMCGk5xX7wqoMQbyr4boaCA2+CUlpfI7/wbIOBeY3qZLC8AAAAASUVORK5CYII=","width":150,"height":150,"src":"/static/4e96f1110cb872407e837d4fc1440f96/92ab1/ts-thumb.png","srcSet":"/static/4e96f1110cb872407e837d4fc1440f96/92ab1/ts-thumb.png 1x,\n/static/4e96f1110cb872407e837d4fc1440f96/668a7/ts-thumb.png 1.5x,\n/static/4e96f1110cb872407e837d4fc1440f96/56e34/ts-thumb.png 2x"}}}}}},"pageContext":{"slug":"/api-service-controller/","previous":{"id":"63e5b308-d9d5-516f-963e-c16a309f26ba","frontmatter":{"title":"Lập trình hướng đối tượng trong javascript","tags":["javascript","basic"],"template":"post"},"fields":{"slug":"/oop-in-js/"}},"next":{"id":"9fa6b968-9df1-50ba-9a28-bb32296b406d","frontmatter":{"title":"Chúc mừng năm mới 2021 💟","tags":["note"],"template":"post"},"fields":{"slug":"/happy-new-year-2021/"}}}},"staticQueryHashes":[]}