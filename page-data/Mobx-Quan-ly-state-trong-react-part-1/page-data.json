{"componentChunkName":"component---src-templates-post-js","path":"/Mobx-Quan-ly-state-trong-react-part-1/","result":{"data":{"markdownRemark":{"html":"<h2 id=\"lời-nói-đầu\" style=\"position:relative;\"><a href=\"#l%E1%BB%9Di-n%C3%B3i-%C4%91%E1%BA%A7u\" aria-label=\"lời nói đầu permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lời nói đầu</h2>\n<p>Nếu bạn các bạn học tập và làm việc với react sẽ làm việc với <em>state</em> thường xuyên. Đào sâu hơn sẽ là khái niệm <em>state management</em>.\nBài này mình sẽ giới thiệu về Mobx, một thư viện để quản lý state, mời các bạn đón đọc.</p>\n<h2 id=\"tại-sao-lại-cần-quản-lý-state\" style=\"position:relative;\"><a href=\"#t%E1%BA%A1i-sao-l%E1%BA%A1i-c%E1%BA%A7n-qu%E1%BA%A3n-l%C3%BD-state\" aria-label=\"tại sao lại cần quản lý state permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tại sao lại cần quản lý state?</h2>\n<p>Thông thường trong react, nếu muốn truyền dữ liệu của thằng cha xuống thằng con chúng ta thường xuyên phải truyền props. bạn hãy tưởng tượng. Chúng ta có một component cha cực lớn bao gồm n component con, trường hợp tệ nhất ta phải truyền n props xuống n component con. Thật sự ác mộng phải không? Vì thế việc quản lý state sao cho hợp lý đã được tính toán. Trong đó có hai thư viện cực nổi tiếng đó là <strong>Mobx</strong> và <strong>Redux</strong>.</p>\n<!--more-->\n<h2 id=\"tại-sao-mình-lại-chọn-mobx-để-giới-thiệu-cho-các-bạn\" style=\"position:relative;\"><a href=\"#t%E1%BA%A1i-sao-m%C3%ACnh-l%E1%BA%A1i-ch%E1%BB%8Dn-mobx-%C4%91%E1%BB%83-gi%E1%BB%9Bi-thi%E1%BB%87u-cho-c%C3%A1c-b%E1%BA%A1n\" aria-label=\"tại sao mình lại chọn mobx để giới thiệu cho các bạn permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tại sao mình lại chọn Mobx để giới thiệu cho các bạn</h2>\n<p>Mình đã từng làm việc cùng redux khá nhiều và cảm thấy code khá nhì nhằng, có nhiều khái niệm khó hiểu cho những người mới học. Một thời gian sau mình biết đến Mobx và phải thốt lên là tại sao mình lại không học Mobx trước nhỉ, bởi đơn giản là Mobx học dễ nhiểu hơn nhiều. Vì thế mình muốn các bạn tiếp cận Mobx trước. Nhưng điều đó không có nghĩa là mình bỏ qua Redux, có lẽ tuần sau mình sẽ viết redux, mong các bạn đón đọc nha.</p>\n<h2 id=\"mobx-là-gì\" style=\"position:relative;\"><a href=\"#mobx-l%C3%A0-g%C3%AC\" aria-label=\"mobx là gì permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mobx là gì?</h2>\n<p>MobX rất đơn giản, có thể mở rộng (scalable) và là một giải pháp để quản lý trạng thái (state management). MobX là một thư viện độc lập, nhưng hầu hết mọi người sử dụng nó với React và hướng dẫn sau sẽ tập trung vào sự kết hợp đó.</p>\n<h2 id=\"những-điều-cần-lưu-ý-khi-dùng-mobx\" style=\"position:relative;\"><a href=\"#nh%E1%BB%AFng-%C4%91i%E1%BB%81u-c%E1%BA%A7n-l%C6%B0u-%C3%BD-khi-d%C3%B9ng-mobx\" aria-label=\"những điều cần lưu ý khi dùng mobx permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Những điều cần lưu ý khi dùng Mobx</h2>\n<p>Mobx là mutable, có nghĩa là chúng ta sẽ thay đổi hoàn toàn trực tiếp, thay vì immutable như Redux.\nCode của Mobx cực ngắn và dễ hiểu.</p>\n<h2 id=\"mobx-trong-react\" style=\"position:relative;\"><a href=\"#mobx-trong-react\" aria-label=\"mobx trong react permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mobx trong react</h2>\n<p>Trang chủ <a href=\"https://mobx-react.js.org/\">mobx-react</a> chỉ hướng dẫn chúng ta viết mobx với function component tuy nhiên với class component cũng tương tự như vậy.\nDưới đây mình sẽ giới thiệu các hàm, các chức năng cơ bản của Mobx.</p>\n<h3 id=\"observable\" style=\"position:relative;\"><a href=\"#observable\" aria-label=\"observable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Observable</h3>\n<p>Giá trị observable có thể là primitives values (number, string, boolean, null, undefined), reference values (array, objects, function), plain object, class instance, ES6 Map, Set,… Nó là những giá trị mà component sẽ quan sát để biết có nên re-render hay không? Các bạn có thể tìm hiểu thêm về nó thông qua <a href=\"https://mobx.js.org/refguide/observable.html\">https://mobx.js.org/refguide/observable.html</a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">// Có hai cách viết như sau</span>\n\n<span class=\"token comment\">// Theo doi mot mang</span>\n<span class=\"token keyword\">const</span> list <span class=\"token operator\">=</span> <span class=\"token function\">observable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nlist<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\n\n<span class=\"token comment\">// Thay doi mot property cua object</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Todo</span> <span class=\"token punctuation\">{</span>\n  @observable title <span class=\"token operator\">=</span> <span class=\"token string\">'Mua banh mi'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">TODO</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Todo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token constant\">TODO</span><span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token string\">'Da mua banh mi'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Hoac la</span>\n<span class=\"token keyword\">const</span> person <span class=\"token operator\">=</span> <span class=\"token function\">observable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    firstName<span class=\"token operator\">:</span> <span class=\"token string\">\"Clive Staples\"</span><span class=\"token punctuation\">,</span>\n    lastName<span class=\"token operator\">:</span> <span class=\"token string\">\"Lewis\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nperson<span class=\"token punctuation\">.</span>firstName <span class=\"token operator\">=</span> <span class=\"token string\">\"C.S.\"</span></code></pre></div>\n<p>Tất cả đều là mutate trực tiếp vào chính object (hoặc mảng).</p>\n<h3 id=\"observer\" style=\"position:relative;\"><a href=\"#observer\" aria-label=\"observer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Observer</h3>\n<p>Chắc là nhiều bạn sẽ nhầm lẫn với observable bên trên. Nhìn thì nó viết tương tự nhau nhưng chức năng của nó thì hoàn toàn không liên quan gì nhau.\nTrong khi Observable là đại diện cho các giá trị được component quan sát thì Observer là một HOC hay decorator subscribes mà giúp cho component có khả năng quan sát. Kết quả là, component sẽ tự động được render khi những giá trị observables liên quan thay đổi. Ở đây, có 2 packages cho phép sử dụng observer.\nmobx-react: chỉ hỗ trợ cho class component.\nmobx-react-lite: chỉ hỗ trợ cho functional component và kích thước cũng nhỏ hơn rất nhiều.</p>\n<h3 id=\"tạo-một-component-với-observer\" style=\"position:relative;\"><a href=\"#t%E1%BA%A1o-m%E1%BB%99t-component-v%E1%BB%9Bi-observer\" aria-label=\"tạo một component với observer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tạo một component với observer</h3>\n<p>Chúng ta có 3 cách để observer một component</p>\n<ul>\n<li>😎 <a href=\"https://mobx-react.js.org/observer-hoc\">observer HOC</a> (tốt và phổ biến nhất)</li>\n<li>🤓 <a href=\"https://mobx-react.js.org/observer-component\">observer component</a></li>\n<li>🧐 <a href=\"https://mobx-react.js.org/observer-hook\">useObserver hook</a></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> observable <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Observer<span class=\"token punctuation\">,</span> useObserver<span class=\"token punctuation\">,</span> observer <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx-react'</span> <span class=\"token comment\">// 6.x or mobx-react-lite@1.4.0</span>\n<span class=\"token keyword\">import</span> ReactDOM <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom'</span>\n\n<span class=\"token comment\">// tạo một dữ liệu observable</span>\n<span class=\"token keyword\">const</span> person <span class=\"token operator\">=</span> <span class=\"token function\">observable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  name<span class=\"token operator\">:</span> <span class=\"token string\">'John'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// observer HOC: Observer cả function component</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">P1</span> <span class=\"token operator\">=</span> <span class=\"token function\">observer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token constant\">P1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> person <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>person<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// observer component: chỉ observer cho component con nằm bên trong</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">P2</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> person <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>person<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span> dont want to change my name<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span> <span class=\"token comment\">// sẽ không thay đổi vì không được observer</span>\n    <span class=\"token operator\">&lt;</span>Observer<span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>person<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span> will change to <span class=\"token keyword\">new</span> <span class=\"token class-name\">name<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span></span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Observer<span class=\"token operator\">></span> <span class=\"token comment\">// thay đổi</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// useObserver hook - trả về một component mới được observer</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">P3</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> person <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">useObserver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>person<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">DetailPerson</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token constant\">P1</span> person<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>person<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token constant\">P2</span> person<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>person<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token constant\">P3</span> person<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>person<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Sau 3 giây chúng ta sẽ thay đổi dữ liệu của person</span>\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  person<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token string\">'Jane'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Bạn có thể edit <a href=\"https://codesandbox.io/s/4qrv105l47?fontsize=14\">code sanbox</a></p>\n<h3 id=\"cấu-trúc-của-mobx-nên-viết-trong-react\" style=\"position:relative;\"><a href=\"#c%E1%BA%A5u-tr%C3%BAc-c%E1%BB%A7a-mobx-n%C3%AAn-vi%E1%BA%BFt-trong-react\" aria-label=\"cấu trúc của mobx nên viết trong react permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cấu trúc của mobx nên viết trong react</h3>\n<p>Theo như mobx team khuyên dùng chúng ta nên sử dụng react context để truyền store.\nChúng ta nên viết một file riêng chứa toàn bộ dữ liệu observable (mình sẽ gọi là <strong>store.ts</strong>), trong file này mình sẽ định nghĩa một <strong>rootStore</strong> (sẽ truyền cái này qua component <strong>Provider</strong>) và một hàm <strong>useStore</strong> (sẽ trả về store). Component nào cần dùng store mình sẽ import <strong>useStore</strong> vào. Để hiểu chi tiết hơn các bạn xem ví dụ bên dưới</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">// store.ts</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> createContext<span class=\"token punctuation\">,</span> useContext <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> observable<span class=\"token punctuation\">,</span> action <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Todo</span> <span class=\"token punctuation\">{</span>\n  @observable title <span class=\"token operator\">=</span> <span class=\"token string\">'Mua banh mi'</span><span class=\"token punctuation\">;</span>\n\n  @action <span class=\"token comment\">// chỉ có action mới có thể modify observable state</span>\n  <span class=\"token function-variable function\">changeTitle</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token string\">'Da mua banh my'</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// changeTitle co the viet lai nhu sau</span>\n  <span class=\"token comment\">//  @action.bound</span>\n  <span class=\"token comment\">//  changeTitle() {</span>\n  <span class=\"token comment\">//    this.title = 'Da mua banh my'</span>\n  <span class=\"token comment\">//  }</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> rootStore <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  todoStore<span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Todo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">TRootStore</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">typeof</span> rootStore<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> RootStoreContext <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">createContext</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token keyword\">null</span> <span class=\"token operator\">|</span> TRootStore<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Tạo ra provider để cung cấp store cho toàn bộ app</span>\n<span class=\"token comment\">// dung trong file index.tsx</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> Provider <span class=\"token operator\">=</span> RootStoreContext<span class=\"token punctuation\">.</span>Provider<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/** tra lai store, chi dung o function component */</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">useStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/** store này sẽ chứa toàn bộ data */</span>\n  <span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>RootStoreContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>store <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Store cannot be null, please add a context provider\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> store<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>chú ý decorator <code class=\"language-text\">@action</code>, từ đầu đến gờ mỗi ví dụ nếu muốn thay đổi giá trị của dữ liệu observable, ta đều phải mutate trưc tiếp, như là <code class=\"language-text\">person.name = &#39;Jane&#39;</code>. Ngoài ra còn một cách khác để thay đổi chính là dùng <code class=\"language-text\">@action</code></p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">// index.tsx</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> render <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Provider<span class=\"token punctuation\">,</span> rootStore <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./store\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> rootElement <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"root\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/** Truyen store vao thong qua provider */</span>\n<span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>Provider value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>rootStore<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Provider<span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n  rootElement\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">// Todo.tsx</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> observer <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Observer<span class=\"token punctuation\">,</span> useObserver<span class=\"token punctuation\">,</span> observer <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx-react-lite'</span>\n<span class=\"token keyword\">import</span> ReactDOM <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom'</span>\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n\n<span class=\"token comment\">// import store</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useStore <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./store'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> Todo <span class=\"token operator\">=</span> <span class=\"token function\">observer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> todoStore <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>title<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>todoStore<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>todoStore<span class=\"token punctuation\">.</span>changeTitle<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Click to change title<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"lưu-ý-về-inject\" style=\"position:relative;\"><a href=\"#l%C6%B0u-%C3%BD-v%E1%BB%81-inject\" aria-label=\"lưu ý về inject permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lưu ý về <em>inject</em></h3>\n<p>Một số bạn search google sẽ có nhiều example dùng decorator <code class=\"language-text\">@inject</code> và component <code class=\"language-text\">Provider</code> (<strong>Provider</strong> này khác với <strong>Provider</strong> mình viết ở trên nhé, Provider này import từ <strong>mobx</strong>). Dùng inject là không sai, tuy nhiên mobx team là khuyên không nên dùng (tại sao lại thế thì mình cũng không rõ). Tuy nhiên họ khuyên không dùng thì tốt nhất là không nên dùng. Một là mình sử dụng React context, mà mình viết ở trên (xem thêm ở <a href=\"https://mobx-react.js.org/recipes-migration\">đây</a>), hai là import thẳng store vào component có nhu cầu sử dụng</p>\n<h2 id=\"kết-luận\" style=\"position:relative;\"><a href=\"#k%E1%BA%BFt-lu%E1%BA%ADn\" aria-label=\"kết luận permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kết luận</h2>\n<p>Part 1 mình đã nói tổng thể cách để tạo ra một store và làm thế nào để component có thể theo dõi cũng như thay đổi store. Phần hai mình sẽ viết về một số function khác để có thể tracking dữ liệu observable như là <code class=\"language-text\">autorun, when...</code>. Các bạn có thể tham khảo trước tại <a href=\"https://mobx.js.org/refguide/autorun.html\">trang chủ mobx</a></p>\n<h2 id=\"nguồn-tham-khảo\" style=\"position:relative;\"><a href=\"#ngu%E1%BB%93n-tham-kh%E1%BA%A3o\" aria-label=\"nguồn tham khảo permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nguồn tham khảo</h2>\n<ul>\n<li><a href=\"https://viblo.asia/p/gioi-thieu-ve-mobx-va-react-trong-muoi-phut-bJzKmyrEK9N\">viblo</a></li>\n<li><a href=\"https://medium.com/@huynhtrongthoai/mobx-c%C3%B3-th%E1%BA%ADt-s%E1%BB%B1-t%E1%BB%91t-%C4%91%E1%BB%83-thay-th%E1%BA%BF-cho-redux-part-1-433fd8a02b2c\">Medium</a></li>\n</ul>","excerpt":"Lời nói đầu Nếu bạn các bạn học tập và làm việc với react sẽ làm việc với state thường xuyên. Đào sâu hơn sẽ là khái niệm state management…","fields":{"slug":"/Mobx-Quan-ly-state-trong-react-part-1/"},"frontmatter":{"title":"Mobx - Quản lý state trong React - Part 1","date":"August 09, 2020","tags":["react","mobx"],"description":"Giải pháp cho quản lý state trong react","thumbnail":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAEjElEQVQ4y5VUe0yTVxS//UAotSXQ8ZIwH2wsc/GPmWU6jDKcLhLY2IAxBlKeIoNJVIYPEJHXeFhQQHklZSbKy2VhkcdgsokCA8asIMLGo9CWVgptoQGGtLXl7H4ftmBkf+wmN/fc8537+84993d+CP3H8AMwzVHAweRnsB39n5E8rkFMuy2UXQWArDZbbEGOzu8U9gqbHgyLoaZvYt73amUA/uzCtLHfhlcGGUsjTDYGzOFPGm23/XtYePnMzvVIYVZRCfAK857XVt0Cr5iEbuz/wgyhOFNz+sdkLJvFQKZ0i41BY1VAM9hhAG9yu4bKWiaUeqlyXjc4q4byh6MDKaNaL0NMYdsfxvQuCFZQ0phuDSx+CgjKwNctaudn38+P1i6deQsGuEHwS2sDtFXmgerMTpjIOAI1tyt+j1LDLgq0nW+yFZ+hQMdWXs2yoqmxTpHiCqpgM5CFWtaq/FCowAcdUngj7xkOI10eTBfrTthCc2nSwgUBuJNnUv/6h1bRWP8yUIgerLi9ghvTya6gOLpJORHj7LlRWfrPHrCaCmfXqY8x4Xpbjz56EUJJf5wSaCkjmrVA7DhV3fMnyDkWevFxJwpsPNjOY9TP4rqQY5015r8pXxJqlWyIVxw17xwui4Ws/umb5L71WjyRIIU1wPzuvzPmMt0BX6nS4BsPtC6C9P0gD2eD/uJuUJ500cg8kSX5TRiz3V0dYgItxecEuO4UhbL6ZGuAdTevNGlP2MHTcLa/wTfhR/9uPtcH5AWcxUXe1yszsdskI26I4kh/0iH6TAhztC/TF07KYc8q9SQE+drUaC6/yJ899hpMRjnuMwCKgthcfa4XTKccXlEX+II0dsfsoAsykk7OYdyVph6ERDF8Qu5z+ZMm6YIX1KnmXe5aitgMsnDrw4YD0jCH85LI17XjAZbSyTAblSiM/XjIA5lT7CIQoQhAXX2Zn0OYcDXDqKq7psYrN4vm5h/dSgUph0kVXh63w/TSXpZZ9fuIpU11oz/0Ihil7yFGfUECxdef0gKdmn/kLdwbEcENBRS9Qofezg5d19QCdGYFifBbUYW3ZxBvkJ2I59t4foDnToDVBijvGcweXtCBcHREU9fJhy/L66Oxm8mydSD73BG1/3xH/0S5BIPcQJj9Cv2w7l8sSzOCbUYgG2xTYAueyKeVl6aXzquhraEOsq+VwW7/iGpSnHCP++IVF0Oq0hSL9Y0tRaflK9GWMB3CvC/5xtkVlmuN/So7+66DNNIufS6QBo9x7b4XLos6xAp1jUTTFALwskJ4P9JRevetDA408DKeLiXugsVwBswEWwzjjJuVgSad2H6mj7OH/stBUPJbRy7mH91vALYaVepSCSkuRoFBujtc6kofAjiU/vrgSkvJOemTjE+h53Ye9JWfhs4czjIWhtbzIvBYnwzZHxFtYgrIed9Hq87Lo8s0Umnyu4fXFBOAdWoa9mIlKo+XQbwvgJORUpG2xHEN0PJHFmnpY88pH1egXVOc5DE9Kr7XRdmJQqD1ZPgRG4kDzoaW1zNCeL6QrLShBWTsjnXjX3P1Np6ZV8uGAAAAAElFTkSuQmCC","width":150,"height":150,"src":"/static/0fd8a6973e72ff7ffe97cab88ca0fd44/92ab1/mobx-thumbnail.png","srcSet":"/static/0fd8a6973e72ff7ffe97cab88ca0fd44/92ab1/mobx-thumbnail.png 1x,\n/static/0fd8a6973e72ff7ffe97cab88ca0fd44/668a7/mobx-thumbnail.png 1.5x,\n/static/0fd8a6973e72ff7ffe97cab88ca0fd44/56e34/mobx-thumbnail.png 2x"}}}}}},"pageContext":{"slug":"/Mobx-Quan-ly-state-trong-react-part-1/","previous":{"id":"5f5d5110-1a42-5216-9272-e23d55a57cc8","frontmatter":{"title":"Hoc (Higher Order Components) trong typescript","tags":["typescript","react"],"template":"post"},"fields":{"slug":"/Hoc-trong-typescript/"}},"next":{"id":"a8a1d219-9a53-5117-b319-0e3232432c9b","frontmatter":{"title":"Mobx - Quản lý state trong React - Part 2","tags":["react","mobx"],"template":"post"},"fields":{"slug":"/Mobx-Quan-ly-state-trong-react-Part-2/"}}}},"staticQueryHashes":[]}